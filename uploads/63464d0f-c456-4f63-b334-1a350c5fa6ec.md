# Windows 11 as Internet Gateway for macOS Ventura

**Created:** 2026-01-06  
**Tags:** #networking #windows #macos #ics #tutorial

---

## Overview

This guide provides a complete procedure for configuring a Windows 11 computer to act as an internet gateway for a macOS Ventura machine on the same local network. This setup uses Windows' Internet Connection Sharing (ICS) feature.

**Use Cases:**
- Sharing a single internet connection between multiple devices
- Temporary network setup for home or small office
- Testing network configurations
- Situations where only one device has internet access

**Important Notes:**
- ICS creates a separate subnet (192.168.137.x) for shared connections
- The Windows PC must remain powered on for the Mac to access the internet
- Performance depends on the Windows host's capabilities
- Not recommended for production environments or large networks

---

## Prerequisites

### Hardware Requirements

**Windows 11 Computer (Gateway/Host):**
- Two network interfaces:
  - One connected to the internet (WiFi, Ethernet, or cellular)
  - One for sharing (typically Ethernet to connect to Mac)
- Administrator privileges
- Stable power supply

**macOS Ventura Computer (Client):**
- Network interface (Ethernet or WiFi)
- Network cable (if using wired connection)

### Network Setup Options

1. **Ethernet Connection (Recommended):**
   - Connect Windows PC to internet via WiFi or primary Ethernet
   - Connect Mac to Windows PC via Ethernet cable (crossover or regular)

2. **WiFi Connection:**
   - Windows PC connected to internet
   - Mac connects to Windows-created wireless network (Mobile Hotspot)

---

## Part 1: Windows 11 Configuration

### Step 1: Verify Network Adapters

1. Press `Win + R` and type `ncpa.cpl`, then press Enter
2. Identify your network adapters:
   - **Internet Connection**: The adapter currently connected to the internet (e.g., "WiFi" or "Ethernet")
   - **Sharing Connection**: The adapter you'll share through (e.g., "Ethernet 2" or secondary network card)

### Step 2: Enable ICS Service

1. Press `Win + R` and type `services.msc`, then press Enter
2. Scroll down to **Internet Connection Sharing (ICS)**
3. Right-click on it and select **Properties**
4. Set the **Startup type** to **Automatic**
5. Click **Start** if the service isn't running
6. Click **Apply** → **OK**

### Step 3: Configure Internet Connection Sharing

1. Press `Win + R` and type `ncpa.cpl`, then press Enter
2. Right-click on your **Internet Connection** adapter (the one with internet access)
3. Select **Properties**
4. Click the **Sharing** tab
5. Check the box: **"Allow other network users to connect through this computer's Internet connection"**
6. From the dropdown menu labeled **"Home networking connection:"**, select your **Sharing Connection** adapter (the one connected to your Mac)
7. (Optional) Check **"Allow other network users to control or disable the shared Internet connection"**
8. Click **OK**

**Expected Result:** Windows will display a notification that the sharing adapter will be set to IP address 192.168.137.1

### Step 4: Verify Sharing Adapter Configuration

1. Press `Win + R` and type `ncpa.cpl`, then press Enter
2. Right-click on your **Sharing Connection** adapter
3. Select **Properties** → **Internet Protocol Version 4 (TCP/IPv4)** → **Properties**
4. Verify it's set to:
   - **IP address:** 192.168.137.1
   - **Subnet mask:** 255.255.255.0
5. Click **OK** to close all dialogs

### Step 5: Configure Windows Firewall (If Necessary)

1. Press `Win + I` to open Settings
2. Navigate to **Privacy & Security** → **Windows Security** → **Firewall & network protection**
3. Ensure the firewall allows ICS traffic
4. If connection issues persist, temporarily disable the firewall to test (remember to re-enable it)

---

## Part 2: macOS Ventura Configuration

### Method A: Automatic Configuration (DHCP)

**Note:** Some users report that ICS DHCP doesn't always work reliably. If this method fails, use Method B.

1. Click the **Apple menu** → **System Settings**
2. Click **Network** in the sidebar
3. Select your network interface (Ethernet or WiFi)
4. Click **Details**
5. Click **TCP/IP** in the left sidebar
6. Verify **Configure IPv4** is set to **Using DHCP**
7. Click **OK**
8. Wait for the Mac to obtain an IP address automatically (192.168.137.x range)

**Test Connection:**
```bash
ping 8.8.8.8
```

If successful, you should see replies. If this method doesn't work, proceed to Method B.

### Method B: Manual Configuration (Static IP)

This method is more reliable when ICS DHCP service isn't working properly.

1. Click the **Apple menu** → **System Settings**
2. Click **Network** in the sidebar
3. Select your network interface (Ethernet or WiFi connected to Windows PC)
4. Click **Details**
5. Click **TCP/IP** in the left sidebar
6. Click the **Configure IPv4** dropdown and select **Manually**
7. Enter the following settings:
   - **IPv4 Address:** `192.168.137.10` (or any number from 2-254 except 1)
   - **Subnet Mask:** `255.255.255.0`
   - **Router:** `192.168.137.1` (this is the Windows PC)
8. Click **DNS** in the left sidebar
9. Click the **+** button and add DNS servers:
   - **Primary:** `8.8.8.8` (Google DNS)
   - **Secondary:** `8.8.4.4` (Google DNS alternate)
   - Or use: `1.1.1.1` and `1.0.0.1` (Cloudflare DNS)
10. Click **OK**

**Test Connection:**
```bash
# Test gateway connectivity
ping 192.168.137.1

# Test internet connectivity
ping 8.8.8.8

# Test DNS resolution
ping google.com
```

---

## Part 3: Troubleshooting

### Issue 1: Mac Not Getting IP Address (DHCP Failure)

**Symptoms:**
- Mac shows "Self-Assigned IP" or 169.254.x.x address
- No internet connectivity

**Solution:**
- Use Method B (Manual Configuration) instead
- On Windows, verify the ICS service is running (`services.msc`)
- Restart both the Windows PC and Mac
- Disable and re-enable ICS on Windows

### Issue 2: Mac Gets IP But No Internet

**Symptoms:**
- Mac has 192.168.137.x address
- Can ping 192.168.137.1 (Windows gateway)
- Cannot reach internet sites

**Solutions:**

**On Windows:**
1. Check Windows Firewall settings
2. Verify the internet connection is active on Windows
3. Disable ICS, restart, then re-enable ICS
4. Run Command Prompt as Administrator:
   ```cmd
   netsh winsock reset
   netsh int ip reset
   ipconfig /release
   ipconfig /renew
   ipconfig /flushdns
   ```
5. Restart Windows PC

**On Mac:**
1. Verify DNS settings are correct (see Method B, step 9)
2. Clear DNS cache:
   ```bash
   sudo dscacheutil -flushcache
   sudo killall -HUP mDNSResponder
   ```
3. Try different DNS servers

### Issue 3: Intermittent Connection

**Symptoms:**
- Connection works then stops
- Slow or unstable performance

**Solutions:**
- Ensure Windows PC isn't going to sleep or hibernating
- Disable power saving on network adapters:
  1. `Win + R` → `devmgmt.msc`
  2. Expand **Network adapters**
  3. Right-click each adapter → **Properties**
  4. **Power Management** tab
  5. Uncheck **"Allow the computer to turn off this device to save power"**
- Check for Windows updates
- Update network adapter drivers on Windows

### Issue 4: "Network is Inactive" Error on Mac

**Symptoms:**
- macOS shows network as inactive despite being connected
- Can't apply network settings

**Solutions:**
1. Disconnect and reconnect the network cable
2. Turn WiFi off and on (if using WiFi)
3. Create a new network location:
   - **System Settings** → **Network**
   - Click the **⋯** (three dots) → **Set Service Order**
   - Click **+** to add a new location
   - Configure the new location with Manual settings
4. Reset network settings on Mac:
   ```bash
   sudo ifconfig en0 down
   sudo ifconfig en0 up
   ```

### Issue 5: Windows ICS Service Won't Start

**Symptoms:**
- Error when enabling ICS
- Service fails to start

**Solutions:**
1. Check for conflicting services (VPN, WSL, virtual machines)
2. Verify both network adapters are enabled and functioning
3. Run Command Prompt as Administrator:
   ```cmd
   sc config SharedAccess start= auto
   net start SharedAccess
   ```
4. Check Event Viewer for specific error messages:
   - `Win + X` → **Event Viewer**
   - Navigate to **Windows Logs** → **System**
   - Look for SharedAccess errors

### Issue 6: Security Software Blocking Connection

**Symptoms:**
- Connection fails despite correct configuration
- Firewall warnings

**Solutions:**
- Temporarily disable third-party antivirus/firewall to test
- Add exceptions for the 192.168.137.x subnet
- Ensure ports 67 and 68 (UDP) are open for DHCP

---

## Part 4: Testing and Verification

### On Windows (Gateway)

1. Open Command Prompt:
   ```cmd
   ipconfig /all
   ```
   Verify the sharing adapter shows:
   - IP: 192.168.137.1
   - Subnet: 255.255.255.0

2. Check ICS status:
   ```cmd
   sc query SharedAccess
   ```
   Should show STATE: RUNNING

### On macOS (Client)

1. Open Terminal and run:
   ```bash
   ifconfig
   ```
   Look for your interface (en0, en1, etc.) and verify it has a 192.168.137.x address

2. Check routing:
   ```bash
   netstat -nr | grep default
   ```
   Should show 192.168.137.1 as the default gateway

3. Test connectivity:
   ```bash
   # Test gateway
   ping -c 4 192.168.137.1
   
   # Test internet
   ping -c 4 8.8.8.8
   
   # Test DNS
   ping -c 4 google.com
   
   # Check trace route
   traceroute google.com
   ```

4. Test actual browsing:
   - Open Safari or another browser
   - Navigate to various websites
   - Test HTTPS sites specifically

---

## Part 5: Performance Optimization

### Optimize Windows Host

1. **Disable unnecessary network features:**
   - Network adapter properties → Disable IPv6 if not needed
   - Disable network discovery if not required

2. **Update network drivers:**
   - `Win + X` → Device Manager
   - Update all network adapter drivers

3. **Adjust power settings:**
   - Control Panel → Power Options → Change plan settings
   - Set to High Performance when acting as gateway

### Optimize macOS Client

1. **Disable unused network services:**
   ```bash
   # List all network services
   networksetup -listallnetworkservices
   
   # Disable unused services (example)
   sudo networksetup -setnetworkserviceenabled "Bluetooth PAN" off
   ```

2. **Set MTU if needed:**
   ```bash
   networksetup -setMTU Ethernet 1500
   ```

---

## Part 6: Alternative Methods

### Using Mobile Hotspot (Windows 11)

If you prefer wireless sharing:

1. Press `Win + I` → **Network & Internet**
2. Click **Mobile hotspot**
3. Turn on **Share my Internet connection with other devices**
4. Select the internet connection to share from dropdown
5. Choose **WiFi** as sharing method
6. Note the Network name and Password
7. Configure security settings as needed

**On macOS:**
- Connect to the WiFi network created by Windows
- Should work automatically with DHCP

### Using Third-Party Software

Alternative tools if ICS doesn't meet your needs:
- **Connectify Hotspot** (Windows)
- **Virtual Router** (Windows, open-source)
- **Physical router/switch** (hardware solution)

---

## Part 7: Security Considerations

### Important Security Notes

1. **All traffic routes through Windows PC:**
   - The Windows host can potentially monitor all network traffic
   - Not recommended for sensitive corporate networks

2. **Basic NAT protection only:**
   - ICS provides basic Network Address Translation
   - No advanced firewall features
   - No intrusion detection

3. **Recommendations:**
   - Use strong passwords on Windows account
   - Keep Windows fully updated
   - Enable Windows Defender/antivirus
   - Use VPN on macOS for sensitive traffic
   - Don't use for production/enterprise environments

4. **Network isolation:**
   - ICS creates a separate subnet (192.168.137.x)
   - Mac cannot directly access devices on Windows' main network
   - This provides some isolation but is not a security feature

---

## Part 8: Removing ICS Configuration

### To Disable ICS on Windows

1. Press `Win + R` and type `ncpa.cpl`
2. Right-click the internet connection adapter
3. Select **Properties** → **Sharing** tab
4. Uncheck **"Allow other network users to connect through this computer's Internet connection"**
5. Click **OK**
6. The sharing adapter will revert to DHCP or its previous configuration

### To Reset macOS Network Settings

1. **System Settings** → **Network**
2. Select the interface used for ICS
3. Click **Details**
4. Change **Configure IPv4** back to **Using DHCP**
5. Remove custom DNS servers if added
6. Click **OK**

---

## Quick Reference: Network Settings Summary

### Windows Gateway Configuration
```
Internet Adapter: Connected to internet (no changes needed)
Sharing Adapter:
  - IP Address: 192.168.137.1
  - Subnet Mask: 255.255.255.0
  - DHCP Enabled: Yes (automatic via ICS)
ICS Service: Running (Automatic startup)
```

### macOS Client Configuration (Manual Method)
```
IP Address: 192.168.137.10 (or any 2-254)
Subnet Mask: 255.255.255.0
Router/Gateway: 192.168.137.1
DNS Servers: 8.8.8.8, 8.8.4.4
```

---

## Common Commands Reference

### Windows Commands
```cmd
# View network configuration
ipconfig /all

# Release and renew IP
ipconfig /release
ipconfig /renew

# Flush DNS cache
ipconfig /flushdns

# Reset network stack
netsh winsock reset
netsh int ip reset

# Check ICS service status
sc query SharedAccess

# Start ICS service
net start SharedAccess

# View network connections
ncpa.cpl
```

### macOS Commands
```bash
# View network configuration
ifconfig

# View routing table
netstat -nr

# List network services
networksetup -listallnetworkservices

# Renew DHCP lease
sudo ipconfig set en0 DHCP

# Set manual IP (en0 is typically Ethernet)
sudo networksetup -setmanual "Ethernet" 192.168.137.10 255.255.255.0 192.168.137.1

# Set DNS servers
sudo networksetup -setdnsservers "Ethernet" 8.8.8.8 8.8.4.4

# Flush DNS cache
sudo dscacheutil -flushcache
sudo killall -HUP mDNSResponder

# Test connectivity
ping 192.168.137.1      # Test gateway
ping 8.8.8.8            # Test internet
ping google.com         # Test DNS
traceroute google.com   # Trace route to internet
```

---

## Resources and References

### Official Documentation
- [Microsoft: Internet Connection Sharing Documentation](https://learn.microsoft.com/en-us/troubleshoot/windows-server/networking/set-up-internet-connection-sharing)
- [Apple: macOS Network Settings](https://support.apple.com/guide/mac-help/use-dhcp-or-a-manual-ip-address-on-mac-mchlp2718/mac)

### Key Concepts
- **ICS (Internet Connection Sharing):** Windows feature that enables sharing an internet connection
- **NAT (Network Address Translation):** Technology that allows multiple devices to share a single public IP
- **DHCP (Dynamic Host Configuration Protocol):** Automatic IP address assignment
- **Gateway:** Device that routes traffic between networks (Windows PC in this setup)
- **Static IP:** Manually configured IP address that doesn't change

### Limitations to Be Aware Of
- Performance depends on Windows PC hardware
- Windows PC must remain powered on
- Single point of failure (if Windows crashes, Mac loses internet)
- Limited to small networks (home/small office use)
- No advanced network features (QoS, VLANs, etc.)
- ICS DHCP server sometimes unreliable (hence manual configuration option)

---

## Notes and Tips

- **For best results:** Use Method B (Manual Configuration) on macOS as it's more reliable
- **Connection stability:** Keep Windows PC plugged into power and disable sleep/hibernation
- **Testing:** Always test with ping before assuming internet access is working
- **DNS issues:** If websites don't load but ping works, it's likely a DNS problem
- **Corporate networks:** Check with IT before using ICS; many organizations block it
- **VPN usage:** If Windows is using VPN, all Mac traffic will route through the VPN
- **Backup connection:** Keep alternative internet access method available during setup

---

## Changelog

- 2026-01-06: Initial documentation created
- Covers Windows 11 (Build 22000+) and macOS Ventura (13.x)

---

**Last Updated:** January 6, 2026  
**Status:** Active Guide  
**Difficulty Level:** Intermediate
