{% extends "md2docx/base.html" %}

{% block title %}Status â€” md2docx{% endblock %}

{% block content %}
  <div class="card stack" style="gap:12px;">
    <div class="flex-between" style="gap:10px;">
      <div>
        <h2 style="margin:0 0 4px;">Conversion status</h2>
        <p class="muted" style="margin:0;">Keep this page open; it updates as the task progresses.</p>
      </div>
      <span class="pill">Live status</span>
    </div>

    {% if task is mapping %}
      <p style="margin:0;">Task id: <strong>{{ task.task_id }}</strong></p>
      <p style="margin:0;">Status: <strong>{{ task.status }}</strong></p>
      <div class="progress-outer">
        <div class="progress-inner" style="width:{{ task.progress|default:0 }}%;"></div>
      </div>
      {% if task.download_url %}
        <a class="btn btn-primary" style="width:max-content;" href="{{ task.download_url }}">Download result</a>
      {% endif %}
    {% else %}
      <p style="margin:0;">Task id: <strong>{{ task.id }}</strong></p>
      <p style="margin:0;">Status: <strong>{{ task.status }}</strong></p>
      <div class="progress-outer">
        <div class="progress-inner" style="width:{{ task.progress|default:0 }}%;"></div>
      </div>
      {% if task.result_file %}
        <a class="btn btn-primary" style="width:max-content;" href="{% url 'md2docx:download' task.id %}">Download result</a>
      {% else %}
        <p class="muted">Result not available yet. Poll this page or use the API status endpoint.</p>
      {% endif %}
    {% endif %}
  </div>

{% endblock %}
